# Network Programming Final - 遊戲商城系統 (HW3: Game Store System)

## 作業目標

本作業的核心目標，是實作一個整合**遊戲大廳（Lobby）與遊戲商城（Store）**的平台。你將在這次作業中整合先前 HW1 / HW2 的成果，打造一個「可實際 Demo、可多人操作」的完整遊戲體驗，同時提供一個給開發者使用的上架平台。

### 核心需求

1.  **建立開發者平台**
    *   建立一個讓開發者可以管理自己遊戲的系統。
    *   功能：
        1.  上傳遊戲 (雙人 CLI 遊戲 / 雙人 GUI 遊戲 / 多人以上之小遊戲)
        2.  更新遊戲（版本更新）
        3.  下架遊戲
    *   設計一套**統一的遊戲規格**（檔案結構、啟動方式、必要的介面等）。

2.  **優化遊戲大廳與商城平台**
    *   提供介面讓玩家可以：
        1.  瀏覽目前大廳狀態 (玩家列表、房間列表、上架遊戲列表)
        2.  建立房間並遊玩遊戲
        3.  瀏覽商城中的遊戲 (檢視詳細資訊、評分與撰寫評論)
    *   體驗目標：「看得懂現在有哪些遊戲、有哪些房間、有哪些玩家正在做什麼」。

3.  **支援玩家自由遊玩與更新遊戲版本**
    *   遊玩前下載對應遊戲，或自動更新至該遊戲的最新版本。
    *   遊玩時，自動啟動對應的 game client，並連線至 server 端已啟動的 game server。
    *   遊玩結束後，自動釋放相關資源，並回到房間或大廳等待狀態。

---

## 系統架構與 Demo 說明

### Client 端互動方式：Menu-driven Interface

*   **選單式互動介面**：使用者透過一層一層的選單完成操作，不仰賴複雜指令。
*   **目標**：降低學習成本，引導使用者操作。
*   **Demo 限制**：只允許在一開始啟動 Server 與 Client 時使用指令。後續功能若需額外輸入 Shell 指令或參數，視為未完成。
*   **GUI 鼓勵**：鼓勵以 GUI 實作，評分關注狀態切換、介面回饋、畫面更新一致性。
*   **Menu 設計原則**：每一層選單最多約 5 個功能項目，避免單一畫面選項過多。

### UX 建議（從 Demo 操作者角度設計）

1.  **提供快速啟動方式**：使用 `啟動腳本`、`Makefile`、`Docker` 或 `virtualenv`。
2.  **畫面文字與資訊呈現清楚**：操作說明不冗長，排版清晰，有明確的成功/失敗提示。
3.  **User Flow 連貫**：避免碎片化操作 (如：先抄編號再輸入)。
4.  **輸入體驗友善**：以**編號選項**取代手打文字，有錯誤處理機制。
5.  **Input 與背景事件協調**：妥善處理 Server 通知與 Client 輸入的衝突 (避免阻塞)。

### Demo 環境要求與三種角色

1.  **Server 端** (部署於 Linux)
    *   **Data / DB Server**: 資料儲存，重啟後資料不得遺失。
    *   **Developer Server**: 處理遊戲上傳、更新、下架。
    *   **Lobby Server**: 維護大廳狀態 (玩家、房間)，協助建立房間與啟動 game server。
    *   **Uploaded Game**: 存放上架遊戲檔案，供 Lobby Server 下載。

2.  **Developer（遊戲開發者）**
    *   負責實作與測試遊戲，透過 Developer Client 上架/更新。
    *   建議結構：
        ```text
        ├── create_game_template.py
        ├── developer_client.py
        ├── games            # 開發中遊戲（本地測試用）
        │   ├── agario
        │   ├── my_game
        │   └── snake_tutorial
        └── template         # 遊戲範本與腳手架
        ```

3.  **Player（一般玩家）**
    *   透過 Lobby Client 連線，瀏覽、下載、啟動並加入房間。
    *   建議結構：
        ```text
        ├── create_game_template.py
        ├── lobby_client.py
        ├── downloads        # 玩家下載的遊戲
        │   ├── Player1      # 獨立存放每位玩家的下載內容
        │   │   ├── agario
        │   │   ├── my_game
        │   │   └── snake_tutorial
        │   ├── Player2
        │   └── Player3
        └── template
        ```
    *   **注意**：每位玩家下載內容需獨立存放，以模擬多玩家版本不一致的情境。

### Demo 方式與事前準備

1.  **GitHub**: 包含 Developer、Player、Server 端程式碼，清楚的 README。
2.  **Server 部署**: 在 Linux 機器上部署，Demo 前清空資料，確認穩定運作。
3.  **Demo 流程**: 助教 Pull code -> 閱讀 README -> 啟動程式 -> 操作流程。

---

## 作業詳細需求

### 帳號系統規則
*   **分開管理**：Developer 與 Player 帳號獨立。
*   **註冊**：帳號名稱 + 密碼，名稱不得重複。
*   **登入**：驗證帳號密碼。
*   **避免重複登入**：同一帳號同一時間僅允許一個 Session (拒絕新登入或踢掉舊登入)。

### 開發者（Developer） Use Cases

*   **前置**：需登入 Developer 帳號，只能操作自己帳號相關的遊戲。

#### Use Case D1：開發者上架一款新遊戲
*   **目標**：將本地遊戲上架到平台。
*   **步驟**：
    1.  登入 Developer Client。
    2.  選擇「上架新遊戲」。
    3.  輸入資訊 (名稱、簡介、類型、路徑、設定檔)。
    4.  送出申請，上傳檔案。
    5.  顯示成功訊息，更新「我的遊戲列表」。
*   **錯誤處理**：必填未填、路徑不存在、Config 缺漏、連線失敗。

#### Use Case D2：開發者更新已上架遊戲版本
*   **目標**：更新已上架遊戲的版本。
*   **步驟**：
    1.  登入 Developer Client，進入「我的遊戲」。
    2.  選擇要更新的遊戲。
    3.  指定新版本 (版本號、新檔案來源、更新說明)。
    4.  確認更新，上傳。
    5.  顯示成功訊息。
*   **錯誤處理**：無權限、新檔案不存在、版本號不合法、連線失敗。

#### Use Case D3：開發者下架一款遊戲
*   **目標**：暫時或永久移除遊戲。
*   **步驟**：
    1.  登入 Developer Client，進入「我的遊戲」。
    2.  選擇遊戲，選擇「下架」。
    3.  確認下架。
    4.  送出請求，顯示回饋。
*   **錯誤處理**：無權限、有進行中房間 (阻止或標記)、連線失敗。

### 玩家（Player） Use Cases

*   **前置**：需登入 Player 帳號。

#### Use Case P1：玩家瀏覽遊戲商城與詳細資訊
*   **目標**：查看可遊玩遊戲列表與詳細資訊。
*   **步驟**：
    1.  登入 Lobby Client，進入「商城」。
    2.  顯示遊戲列表。
    3.  選擇遊戲，顯示詳細資訊 (名稱、作者、簡介、人數、評分、評論)。
*   **錯誤處理**：無遊戲、列表載入失敗、資訊缺漏。

#### Use Case P2：玩家下載並更新遊戲版本
*   **目標**：一鍵下載或更新遊戲。
*   **步驟**：
    1.  選擇「下載遊戲」。
    2.  選擇遊戲。
    3.  執行下載 (首次) 或 更新 (已有舊版)。
    4.  顯示成功提示。
*   **錯誤處理**：下載失敗、版本已下架。

#### Use Case P3：玩家建立房間並啟動遊戲
*   **目標**：選擇遊戲 -> 建立房間 -> 啟動遊戲 -> 連線。
*   **步驟**：
    1.  選擇「建立房間」。
    2.  選擇遊戲。
    3.  檢查版本 (若無則提示下載/更新)。
    4.  向 Lobby Server 請求建立房間。
    5.  顯示房間資訊。
    6.  啟動 game client 並連線 game server。
*   **錯誤處理**：遊戲已下架、人數上限、啟動/連線失敗。

#### Use Case P4：玩家對遊戲進行評分與留言
*   **目標**：遊戲結束後評分與回饋。
*   **步驟**：
    1.  進入「評分與評論」。
    2.  確認資格 (玩過該遊戲)。
    3.  輸入評分 (1-5) 與評論。
    4.  送出。
*   **錯誤處理**：未玩過、評分越界、評論過長、連線失敗。

### Plugin 相關 Use Case（加分用）

#### Use Case PL1：玩家查看可用 Plugin 清單
*   顯示 Plugin 名稱、簡介、狀態。

#### Use Case PL2：玩家安裝或移除 Plugin
*   安裝/移除不影響主系統功能。

#### Use Case PL3：已安裝 Plugin 的玩家在房間中使用 Plugin 功能
*   如：房間內群組聊天。

#### Use Case PL4：未安裝 Plugin 的玩家仍可正常遊玩
*   未安裝者不會 Crash，可正常遊玩，只是看不到 Plugin 功能。

---

## 評分機制

### 配分說明 (總分 100 + 加分 20)

1.  **系統功能完整度 (55%)**
    *   D1 (10%), D2 (10%), D3 (5%)
    *   P1 (5%), P2 (10%), P3 (10%), P4 (5%)

2.  **遊戲實作程度 (15%, 闖關制)**
    *   關卡 A (5%): 雙人 CLI 遊戲 (完整流程)
    *   關卡 B (+5%): GUI 介面 (基本圖形, 狀態更新)
    *   關卡 C (+5%): 多人同局 (3人以上)

3.  **系統架構與正確性 (5%)**
    *   角色切分, 版本管理, 資料持久化。

4.  **使用者體驗與介面設計 (5%)**
    *   Menu 結構, Demo 流程直覺, 錯誤訊息清楚。

5.  **程式碼品質與文件 (5%)**
    *   可讀性, README 完整度。

6.  **口頭問答與系統理解 (15%)**
    *   架構說明, 功能擴充思路, 異常處理。

7.  **加分項目：Plugin 功能 (最多 20%)**
    *   實作 Plugin 系統 (如聊天室)。
    *   核心：不破壞流程, 有無安裝皆可正常運作。
